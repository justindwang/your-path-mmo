!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=18)}([function(e,t){function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var o={up:{x:0,y:-1},up_right:{x:1,y:-1},right:{x:1,y:0},down_right:{x:1,y:1},down:{x:0,y:1},down_left:{x:-1,y:1},left:{x:-1,y:0},up_left:{x:-1,y:-1}},s={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]},a={monochrome:{hueRange:null,lowerBounds:[[0,0],[100,0]],saturationRange:[0,100],brightnessRange:[0,0]},red:{hueRange:[-26,18],lowerBounds:[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]],saturationRange:[20,100],brightnessRange:[50,100]},orange:{hueRange:[18,46],lowerBounds:[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]],saturationRange:[20,100],brightnessRange:[70,100]},yellow:{hueRange:[46,62],lowerBounds:[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]],saturationRange:[25,100],brightnessRange:[75,100]},green:{hueRange:[62,178],lowerBounds:[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]],saturationRange:[30,100],brightnessRange:[40,100]},blue:{hueRange:[178,257],lowerBounds:[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]],saturationRange:[20,100],brightnessRange:[35,100]},purple:{hueRange:[257,282],lowerBounds:[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]],saturationRange:[20,100],brightnessRange:[42,100]},pink:{hueRange:[282,334],lowerBounds:[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]],saturationRange:[20,100],brightnessRange:[73,100]}};function c(e){var t=function(e){var t=e[0];0===t&&(t=1),360===t&&(t=359),t/=360;var n=e[1]/100,r=e[2]/100,i=Math.floor(6*t),o=6*t-i,s=r*(1-n),a=r*(1-o*n),c=r*(1-(1-o)*n),l=256,u=256,f=256;switch(i){case 0:l=r,u=c,f=s;break;case 1:l=a,u=r,f=s;break;case 2:l=s,u=r,f=c;break;case 3:l=s,u=a,f=r;break;case 4:l=c,u=s,f=r;break;case 5:l=r,u=s,f=a}return[Math.floor(255*l),Math.floor(255*u),Math.floor(255*f)]}(e);function n(e){var t=e.toString(16);return 1==t.length?"0"+t:t}return"#"+n(t[0])+n(t[1])+n(t[2])}function l(e){for(var t in e>=334&&e<=360&&(e-=360),a){var n=a[t];if(n.hueRange&&e>=n.hueRange[0]&&e<=n.hueRange[1])return a[t]}return"Color not found"}function u(e){var t=Math.random();return t+=.618033988749895,t%=1,Math.floor(e[0]+t*(e[1]+1-e[0]))}function f(e){var t=u(function(e){if("number"==typeof parseInt(e)){var t=parseInt(e);if(t<360&&t>0)return[t,t]}if("string"==typeof e)if(a[e]){var n=a[e];if(n.hueRange)return n.hueRange}else if(e.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var r=HexToHSB(e)[0];return[r,r]}return[0,360]}(e));return t<0&&(t=360+t),t}function h(e,t){if("monochrome"===t)return 0;var n=function(e){return l(e).saturationRange}(e);return u([n[0],n[1]])}function p(e,t,n){return u([function(e,t){for(var n=l(e).lowerBounds,r=0;r<n.length-1;r++){var i=n[r][0],o=n[r][1],s=n[r+1][0],a=n[r+1][1];if(t>=i&&t<=s){var c=(a-o)/(s-i);return c*t+(o-c*i)}}return 0}(e,t),100])}function d(e,t){var n=["S","A","B","C","D","E","F"];return n.indexOf(e.rank)>n.indexOf(t.rank)?1:-1}e.exports=Object.freeze({COLORS:{blue:"#2c97de",blue_alt:"#227fbb",yellow:"#f2c500",yellow_alt:"#f59d00",orange:"#e87e04",orange_alt:"#d55400",red:"#e94b35",red_alt:"#c23824",green:"#428700",green_alt:"#1aaf5d",purple:"#9c56b8",purple_alt:"#8f3faf",teal:"#00bd9c",teal_alt:"#00a185",slate:"#33495f",slate_alt:"#2b3e51",gray:"#95a5a6",gray_alt:"#7f8c8d",light_blue:"#add8e6",light_green:"#90ee90",dark_green:"#013220",brown:"#281c11",light_brown:"#513922",carnation_pink:"#ffa6c9",peach:"#f6b26b",forest_green:"#014421",oak_brown:"#806517",dark_gray:"#5A5A5A",golden_oak:"#bb8141",dirty_water:"#d0eee1",cave_floor:"#ab946f",cave_wall:"#1e202a",salt_floor:"#f5f5f5",salt_wall:"#46769b",mp_blue:"#4932b9",exp_green:"#77dd77",hp_red:"#9a2828",stat_yellow:"#FDFD96",S_brown:"#a52a2a",A_orchid:"#da70d6",B_aero:"#85B9E1ff",C_cadetblue:"#5f9ea0",D_pastelgreen:"#77dd77",E_goldenrod:"#daa520",F_peachpuff:"#ffdab9"},merge:function(e){for(var t=Array.prototype.slice.call(arguments,1),n=0;n<t.length;n++){var r=t[n];for(var i in r)e[i]=r[i]}return e},getOffsetCoordsFromDirection:function(e){return{x:o[e].x,y:o[e].y}},getTileDistance:function(e,t,n,r){var i=Math.abs(n-e),o=Math.abs(r-t);return Math.max(i,o)},random:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},truncateToFiveCharacters:function(e){return Math.abs(e)>=1e9?(e/1e9).toFixed(1)+"B":Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"M":Math.abs(e)>=1e3?(e/1e3).toFixed(1)+"K":e.toString()},truncateToFourCharacters:function(e){return Math.abs(e)>=1e9?(e/1e9).toFixed(0)+"B":Math.abs(e)>=1e6?(e/1e6).toFixed(0)+"M":Math.abs(e)>=1e3?(e/1e3).toFixed(0)+"K":e.toString()},mapLengthToFlexTd:function(e){return e>10?"5px":e>6?"20px":"40px"},mapJobToSize:function(e){var t=e.substring(0,15),n=e.substring(15);if(!t.endsWith(" ")){var r=t.lastIndexOf(" ");-1!==r?(t=t.substring(0,r),(n=e.substring(r+1)).length>15&&(t=e.substring(0,e.length/2),n=e.substring(e.length/2),t.length<n.length?t+="-":n="-"+n)):"-"!==n.charAt(0)&&(t.length<n.length?t+="-":n="-"+n)}return{text:t.trim()+" "+n.trim(),width:6*Math.max(t.length,n.length),maxLength:Math.max(t.length,n.length)}},prettyprint:function(e){for(var t="",n=0;n<e.length;n++){for(var r=0;r<e[n].length;r++)t+=e[n][r]+" ";console.log(t),t=""}},prettyprint2:function(e){for(var t="",n=0;n<e.length;n++){for(var r=0;r<e[n].length;r++)e[n][r]&&(t+=e[n][r][0]+" ");console.log(t),t=""}},apply2D:function(e,t){for(var n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)e[n][r]=t(e[n][r])},getRandomFromRate:function(e){var t,n=Object.keys(e),i=[],o=0,s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw s}}}}(n.map((function(t){return e[t]})));try{for(s.s();!(t=s.n()).done;){o+=t.value,i.push(o)}}catch(e){s.e(e)}finally{s.f()}for(var a=Math.random(),c=0;c<i.length;c++)if(a<i[c])return n[c]},mapAbbrToStat:function(e){switch(e){case"Str":return"strength";case"Agi":return"agility";case"Int":return"intelligence";case"Vit":return"vitality";case"Luck":return"luck";default:return"error"}},mapRankToColor:function(e){switch(e){case"S":return"#a52a2a";case"A":return"#da70d6";case"B":return"#85B9E1ff";case"C":return"#5f9ea0";case"D":return"#77dd77";case"E":return"#daa520";case"F":return"#ffdab9";case"Unique":return"#50577A";default:return"#ffdab9"}},mapGroupToIcon:function(e){switch(e){case"healing":case"mp_recovery":return'<img src="assets/heal.png"/>';case"weapon":return'<img src="assets/weapon.png"/>';case"material":return'<img src="assets/drops.png"/>';case"special":return'<img src="assets/special.png"/>';case"combat":return'<img src="assets/weapon.png"/>';case"misc":return'<img src="assets/stats.png"/>'}},rankToColorHtml:function(e){switch(e){case"S":return'<span style="color:brown">';case"A":return'<span style="color:orchid">';case"B":return'<span style="color:#85B9E1ff">';case"C":return'<span style="color:cadetblue">';case"D":return'<span style="color: #77DD77">';case"E":return'<span style="color:goldenrod">';case"F":default:return'<span style="color:peachpuff">'}},sortArrayOfObjects:function(e,t){return"rank"==t?e.sort((function(e,t){return d(e,t)})):e.sort((function(e,n){return e[t]>n[t]?1:-1}))},sortedArrayOfObjectsCopy:function(e,t){var r=n(e);return"rank"==t?r.sort((function(e,t){return d(e,t)})):r.sort((function(e,n){return e[t]>n[t]?1:-1})),r},selectRandomElement:function(e){return e[Math.floor(Math.random()*e.length)]},compareArraysOfObjects:function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++){var r=Object.keys(e[n]),i=Object.keys(t[n]);if(r.length!==i.length)return!1;for(var o=0,s=r;o<s.length;o++){var a=s[o];if(e[n][a]!==t[n][a])return!1}}return!0},compareObjects:function(e,t){if(e&&t){var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++){var o=n[i];if(e[o]!==t[o])return!1}return!0}},arrFind:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r][t]==n)return e[r];return!1},add_:function(e,t){for(var n=0;n<3;n++)for(var r=1;r<arguments.length;r++)e[n]+=arguments[r][n];return e},add:function(e,t){for(var n=e.slice(),r=0;r<3;r++)for(var i=1;i<arguments.length;i++)n[r]+=arguments[i][r];return n},subtract:function(e,t){for(var n=e.slice(),r=0;r<3;r++)for(var i=1;i<arguments.length;i++)n[r]-=arguments[i][r];return n},_clamp:function(e){return e<0?0:e>255?255:e},toRGB:function(e){var t=function(e){return e<0?0:e>255?255:e};return"rgb("+t(e[0])+","+t(e[1])+","+t(e[2])+")"},interpolate:function(e,t,n){arguments.length<3&&(n=.5);for(var r=e.slice(),i=0;i<3;i++)r[i]=Math.round(r[i]+n*(t[i]-e[i]));return r},fromString:function(e){var t,n;if(e in s)t=s[e];else{if("#"==e.charAt(0)){var r=e.match(/[0-9a-f]/gi).map((function(e){return parseInt(e,16)}));if(3==r.length)t=r.map((function(e){return 17*e}));else{for(var i=0;i<3;i++)r[i+1]+=16*r[i],r.splice(i,1);t=r}}else t=(n=e.match(/rgb\(([0-9, ]+)\)/i))?n[1].split(/\s*,\s*/).map((function(e){return parseInt(e)})):[0,0,0];s[e]=t}return t.slice()},randomColor:function(e){var t,n;return c([t=f(e),n=h(t,e),p(t,n)])},serializeArray:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].serializeForMenuUpdate());return t},exportArr:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].type);return JSON.stringify(t)},findNthTile:function(e,t,n,r,i){for(var o=Math.abs(n-e),s=Math.abs(r-t),a=e<n?1:-1,c=t<r?1:-1,l=o-s,u=e,f=t,h=0;u!==n||f!==r;){if(h==i)return{x:u,y:f};h++;var p=2*l;p>-s&&(l-=s,u+=a),p<o&&(l+=o,f+=c)}return{x:n,y:r}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return a}));var r=n(1);const i="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),o=r.a.WebSocket||r.a.MozWebSocket,s=!0,a="arraybuffer"},function(e,t,n){"use strict";n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return B})),n.d(t,"g",(function(){return C})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return w})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return k}));const r=Object.create(null);r.open="0",r.close="1",r.ping="2",r.pong="3",r.message="4",r.upgrade="5",r.noop="6";const i=Object.create(null);Object.keys(r).forEach(e=>{i[r[e]]=e});const o={type:"error",data:"parser error"},s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),a="function"==typeof ArrayBuffer,c=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,l=({type:e,data:t},n,i)=>s&&t instanceof Blob?n?i(t):u(t,i):a&&(t instanceof ArrayBuffer||c(t))?n?i(t):u(new Blob([t]),i):i(r[e]+(t||"")),u=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function f(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let h;const p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<p.length;e++)d[p.charCodeAt(e)]=e;const g="function"==typeof ArrayBuffer,m=(e,t)=>{if("string"!=typeof e)return{type:"message",data:b(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:y(e.substring(1),t)};return i[n]?e.length>1?{type:i[n],data:e.substring(1)}:{type:i[n]}:o},y=(e,t)=>{if(g){const n=(e=>{let t,n,r,i,o,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);const l=new ArrayBuffer(s),u=new Uint8Array(l);for(t=0;t<a;t+=4)n=d[e.charCodeAt(t)],r=d[e.charCodeAt(t+1)],i=d[e.charCodeAt(t+2)],o=d[e.charCodeAt(t+3)],u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|i>>2,u[c++]=(3&i)<<6|63&o;return l})(e);return b(n,t)}return{base64:!0,data:e}},b=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},v=String.fromCharCode(30),w=(e,t)=>{const n=e.length,r=new Array(n);let i=0;e.forEach((e,o)=>{l(e,!1,e=>{r[o]=e,++i===n&&t(r.join(v))})})},k=(e,t)=>{const n=e.split(v),r=[];for(let e=0;e<n.length;e++){const i=m(n[e],t);if(r.push(i),"error"===i.type)break}return r};function _(){return new TransformStream({transform(e,t){!function(e,t){s&&e.data instanceof Blob?e.data.arrayBuffer().then(f).then(t):a&&(e.data instanceof ArrayBuffer||c(e.data))?t(f(e.data)):l(e,!1,e=>{h||(h=new TextEncoder),t(h.encode(e))})}(e,n=>{const r=n.length;let i;if(r<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,r);else if(r<65536){i=new Uint8Array(3);const e=new DataView(i.buffer);e.setUint8(0,126),e.setUint16(1,r)}else{i=new Uint8Array(9);const e=new DataView(i.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(r))}e.data&&"string"!=typeof e.data&&(i[0]|=128),t.enqueue(i),t.enqueue(n)})}})}let E;function T(e){return e.reduce((e,t)=>e+t.length,0)}function A(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let r=0;for(let i=0;i<t;i++)n[i]=e[0][r++],r===e[0].length&&(e.shift(),r=0);return e.length&&r<e[0].length&&(e[0]=e[0].slice(r)),n}function B(e,t){E||(E=new TextDecoder);const n=[];let r=0,i=-1,s=!1;return new TransformStream({transform(a,c){for(n.push(a);;){if(0===r){if(T(n)<1)break;const e=A(n,1);s=128==(128&e[0]),i=127&e[0],r=i<126?3:126===i?1:2}else if(1===r){if(T(n)<2)break;const e=A(n,2);i=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),r=3}else if(2===r){if(T(n)<8)break;const e=A(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),s=t.getUint32(0);if(s>Math.pow(2,21)-1){c.enqueue(o);break}i=s*Math.pow(2,32)+t.getUint32(4),r=3}else{if(T(n)<i)break;const e=A(n,i);c.enqueue(m(s?e:E.decode(e),t)),r=0}if(0===i||i>e){c.enqueue(o);break}}}})}const C=4},function(e,t,n){"use strict";function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}n.d(t,"a",(function(){return r})),r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.emitReserved=r.prototype.emit,r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(1);function i(e,...t){return t.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{})}const o=r.a.setTimeout,s=r.a.clearTimeout;function a(e,t){t.useNativeTimers?(e.setTimeoutFn=o.bind(r.a),e.clearTimeoutFn=s.bind(r.a)):(e.setTimeoutFn=r.a.setTimeout.bind(r.a),e.clearTimeoutFn=r.a.clearTimeout.bind(r.a))}function c(e){return"string"==typeof e?function(e){let t=0,n=0;for(let r=0,i=e.length;r<i;r++)t=e.charCodeAt(r),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),i=n(4),o=n(5),s=n(8);class a extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class c extends i.a{constructor(e){super(),this.writable=!1,Object(o.b)(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new a(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=Object(r.c)(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=Object(s.b)(e);return t.length?"?"+t:""}}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i;function o(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=n(0),a=s.COLORS,c=s.findNthTile;e.exports=Object.freeze({PLAYER_MAX_HP:20,PLAYER_MAX_MP:10,MAP_SIZE:25,RENDER_SIZE:10,TILE_SIZE:60,TICK_RATE:20,DEFAULT_CD:20,MSG_TYPES:{NEW_PLAYER:"new_player",GAME_UPDATE:"update",LOG_MESSAGE:"log_message",INPUT:"input",MOUSE_MAP_INPUT:"mouse_map_input",MENU_INPUT:"menu_input",SKILL_INPUT:"skill_input",AUTHENTICATE:"authenticate",AUTHENTICATED:"authenticated",RESPAWN:"respawn"},MAP_CHAR_TO_TYPE:{"#":"wall",".":"floor",x:"exit"},FLOOR_DATA:{1:{name:"Rolling Meadows",entities:{".":.747,b:.2,s:.05,"-":.001,g:.002},entitySpawner:{slime:.96,goober:.04},furnitureSpawner:{bush:.995,crate:.005},floorBgColor:a.green,wallBgColor:a.light_brown,entityCharToType:{s:"slime",g:"goober"},furnitureCharToType:{b:"bush","+":"door","-":"crate"},itemsCharToType:{},crateLoot:{F:.4,E:.3,D:.25,C:.05}},2:{name:"Verdant Forest",entities:{".":.649,m:.2,T:.1,w:.05,"-":.001},entitySpawner:{wolf:1},furnitureSpawner:{leaf_pile:.664,oak_tree:.332,crate:.004},floorBgColor:a.forest_green,wallBgColor:a.oak_brown,entityCharToType:{w:"wolf"},furnitureCharToType:{m:"leaf_pile","+":"door",T:"oak_tree","-":"crate"},itemsCharToType:{},crateLoot:{F:.4,E:.3,D:.25,C:.05}},3:{name:"Goblin Caverns",entities:{".":.593,g:.05,b:.15,m:.1,w:.1,s:.005,k:.001,"-":.001},entitySpawner:{goblin:.995,goblin_king:.005},furnitureSpawner:{boulder:.421,mud:.28,puddle:.294,crate:.005},floorBgColor:a.cave_floor,wallBgColor:a.cave_wall,entityCharToType:{g:"goblin",k:"goblin_king"},furnitureCharToType:{b:"boulder","+":"door",m:"mud",w:"puddle","-":"crate"},itemsCharToType:{s:"mushroom"},crateLoot:{F:.4,E:.3,D:.25,C:.05}},4:{name:"Salty Flats",entities:{".":.649,r:.05,s:.15,g:.15,"-":.001},entitySpawner:{rock_snail:1},furnitureSpawner:{salt:.5,gravel:.495,crate:.005},floorBgColor:a.salt_floor,wallBgColor:a.salt_wall,entityCharToType:{r:"rock_snail"},furnitureCharToType:{s:"salt","+":"door",g:"gravel","-":"crate"},itemsCharToType:{},crateLoot:{F:.2,E:.4,D:.3,C:.1}}},ENTITY_TYPES:{slime:{name:"Slime",sprite:"slime.png",consoleColor:a.blue,maxTurnsWithoutStumble:3,hp:10,hpMax:10,strength:1,exp:2,aggroRange:0,initialize:function(){},loot:{nothing:.5,monster_shard:.5}},goober:{name:"Goober",sprite:"goober.png",maxTurnsWithoutStumble:2,hp:30,hpMax:30,strength:4,exp:5,aggroRange:0,initialize:function(){},loot:{monster_shard:.6,bouncy_skill_scroll:.4}},wolf:{name:"Wolf",sprite:"wolf.png",consoleColor:a.dark_gray,maxTurnsWithoutStumble:10,hp:30,hpMax:30,strength:3,exp:10,aggroRange:2,initialize:function(){},loot:{nothing:.495,monster_shard:.45,wolf_fang:.05,chomp_skill_scroll:.005}},goblin:{name:"Goblin",sprite:"goblin.png",consoleColor:a.green,maxTurnsWithoutStumble:15,hp:50,hpMax:50,strength:5,exp:20,aggroRange:3,initialize:function(){},loot:{nothing:.5,monster_shard:.3,rusty_dagger:.15,coin_stash:.05}},goblin_king:{name:"Goblin King",sprite:"goblin_king.png",consoleColor:a.dark_green,maxTurnsWithoutStumble:10,hp:100,hpMax:100,strength:10,exp:100,aggroRange:0,initialize:function(){},loot:{kings_resent:.5,coin_stash:.5}},rock_snail:{name:"Rock Snail",sprite:"rock_snail.png",consoleColor:a.green,maxTurnsWithoutStumble:2,hp:60,hpMax:60,strength:10,exp:40,aggroRange:1,initialize:function(){},loot:{nothing:.3,monster_shard:.7}}},FURNITURE_TYPES:{door:{name:"Door",hp:5,hpMax:5,sprite:"door.png",consoleColor:a.yellow,passable:!1,blocksLos:!0,attackable:!1,pushable:!1,openable:!0,mixins:["door"]},crate:(i={name:"Crate",hp:5,hpMax:5,sprite:"crate.png",consoleColor:a.yellow,pushable:!1,passable:!1,blocksLos:!1,attackable:!1},o(i,"pushable",!1),o(i,"openable",!0),i),bush:o({name:"Bush",hp:1,hpMax:1,sprite:"bush.png",consoleColor:a.green,pushable:!0,passable:!1,blocksLos:!1,attackable:!0},"pushable",!0),leaf_pile:o({name:"Leaf Pile",hp:5,hpMax:5,sprite:"leaf_pile.png",consoleColor:a.green,pushable:!1,passable:!0,blocksLos:!1,attackable:!0},"pushable",!1),oak_tree:o({name:"Oak Tree",hp:15,hpMax:15,sprite:"oak_tree.png",consoleColor:a.golden_oak,pushable:!1,passable:!1,blocksLos:!0,attackable:!0},"pushable",!1),boulder:o({name:"Boulder",hp:30,hpMax:30,sprite:"boulder.png",consoleColor:a.gray,pushable:!1,passable:!1,blocksLos:!0,attackable:!0},"pushable",!1),mud:o({name:"Mud",hp:1,hpMax:1,sprite:"mud.png",consoleColor:a.brown,pushable:!1,passable:!0,blocksLos:!1,attackable:!0},"pushable",!1),puddle:o({name:"Puddle",hp:1,hpMax:1,sprite:"puddle.png",consoleColor:a.dirty_water,pushable:!1,passable:!1,blocksLos:!1,attackable:!0},"pushable",!1),salt:o({name:"Salt",hp:50,hpMax:50,sprite:"salt.png",consoleColor:a.dirty_water,pushable:!1,passable:!1,blocksLos:!1,attackable:!0},"pushable",!1),gravel:o({name:"Gravel",hp:1,hpMax:1,sprite:"gravel.png",consoleColor:a.dirty_water,pushable:!1,passable:!0,blocksLos:!1,attackable:!0},"pushable",!1)},OUTFIT_TYPES:{casual_hoodie:{name:"Casual Hoodie",sprite:"casual_hoodie.png",description:"warm and comfy"},casual_blouse:{name:"Casual Blouse",sprite:"casual_blouse.png",description:"comes with cute frills"},keikogi:{name:"Keikogi",sprite:"kendoka.png",description:"made with simple fabrics"},hooded_cloak:{name:"Hooded Cloak",sprite:"ivory_reaper.png",description:"mysterious but stylish"},floral_armor:{name:"Floral Armor",sprite:"flower_fighter.png",description:"a sweet fragrance follows"},midnight_cloak:{name:"Midnight Cloak",sprite:"black_swordsman.png",description:"just a little edgy"},daopao:{name:"Daopao",sprite:"archery_disciple.png",description:"plain and respectful"},tiny_dress:{name:"Tiny Dress",sprite:"preschooler.png",description:"handpicked with love"},patterned_kimono:{name:"Patterned Kimono",sprite:"kitsune.png",description:"beautifully woven"},work_suit:{name:"Work Suit",sprite:"businessman.png",description:"perfectly ironed"},lofty_dress:{name:"Lofty Dress",sprite:"battle_maid.png",description:"orderly and spotless"},autumn_dress:{name:"Autumn Dress",sprite:"enchantress.png",description:"colorful and dazzling"},silver_armor:{name:"Silver Armor",sprite:"knight.png",description:"basic protection"},cobalt_armor:{name:"Cobalt Armor",sprite:"knightess.png",description:"basic protection"},trusty_chainmail:{name:"Trusty Chainmail",sprite:"warrior.png",description:"capable of taking hits"},leather_chainmail:{name:"Leather Chainmail",sprite:"warrioress.png",description:"capable of taking hits"},green_rags:{name:"Green Rags",sprite:"ranger.png",description:"blends with the forest"},flowy_rags:{name:"Flowy Rags",sprite:"archeress.png",description:"blends with the forest"},blue_robe:{name:"Blue Robe",sprite:"mage.png",description:"a magician's staple"},purple_robe:{name:"Purple Robe",sprite:"sorceress.png",description:"a magician's staple"},ninja_gear:{name:"Ninja Gear",sprite:"ninja.png",description:"for hiding in shadows"},black_haori:{name:"Black Haori",sprite:"kunoichi.png",description:"for hiding in shadows"}},TILE_TYPES:{floor:{name:"Floor",color:a.green,bgColor:a.green,passable:!0,blocksLos:!1},wall:{name:"Wall",color:a.light_brown,bgColor:a.light_brown,passable:!1,blocksLos:!0},exit:{name:"Exit",bgColor:a.green,sprite:"exit.png",consoleColor:a.red_alt,passable:!0,blocksLos:!1}},JOB_TYPES:{kendoka:{name:"Kendoka",sprite:"kendoka.png",description:"simple and steadfast",outfit:"keikogi",skill:"zen_strike",equipEffect:function(){},unequipEffect:function(){}},ivory_reaper:{name:"Ivory Reaper",sprite:"ivory_reaper.png",description:"ominous and menacing",outfit:"hooded_cloak",skill:"final_cut",equipEffect:function(){},unequipEffect:function(){}},flower_fighter:{name:"Flower Fighter",sprite:"flower_fighter.png",description:"graceful and vibrant",outfit:"floral_armor",skill:"photosynthesis",equipEffect:function(){},unequipEffect:function(){}},black_swordsman:{name:"Black Swordsman",sprite:"black_swordsman.png",description:"skilled and battle-tested",outfit:"midnight_cloak",skill:"evade",equipEffect:function(){},unequipEffect:function(){}},archery_disciple:{name:"Archery Disciple",sprite:"archery_disciple.png",description:"eager and sharp",outfit:"daopao",skill:"qi_shot",equipEffect:function(){},unequipEffect:function(){}},preschooler:{name:"Preschooler",sprite:"preschooler.png",description:"playful and energetic",outfit:"tiny_dress",skill:"temper_tantrum",equipEffect:function(){},unequipEffect:function(){}},kitsune:{name:"Kitsune",sprite:"kitsune.png",description:"mischievous and wise",outfit:"patterned_kimono",skill:"foxfire",equipEffect:function(){},unequipEffect:function(){}},businessman:{name:"Businessman",sprite:"businessman.png",description:"hardworking and professional",outfit:"work_suit",skill:"cash_flow",equipEffect:function(){},unequipEffect:function(){}},battle_maid:{name:"Battle Maid",sprite:"battle_maid.png",description:"reliable and thorough",outfit:"lofty_dress",skill:"clean_finish",equipEffect:function(){},unequipEffect:function(){}},enchantress:{name:"Enchantress",sprite:"enchantress.png",description:"mystical and alluring",outfit:"autumn_dress",skill:"embrace",equipEffect:function(){},unequipEffect:function(){}},knight:{name:"Knight",sprite:"knight.png",description:"trustworthy and noble",outfit:"silver_armor",skill:"slash",equipEffect:function(){},unequipEffect:function(){}},knightess:{name:"Knightess",sprite:"knightess.png",description:"fearless and gentle",outfit:"cobalt_armor",skill:"slash",equipEffect:function(){},unequipEffect:function(){}},warrior:{name:"Warrior",sprite:"warrior.png",description:"cheerful and durable",outfit:"trusty_chainmail",skill:"smash",equipEffect:function(){},unequipEffect:function(){}},warrioress:{name:"Warrioress",sprite:"warrioress.png",description:"brave and dependable",outfit:"leather_chainmail",skill:"smash",equipEffect:function(){},unequipEffect:function(){}},ranger:{name:"Ranger",sprite:"ranger.png",description:"keen and accurate",outfit:"green_rags",skill:"far_shot",equipEffect:function(){},unequipEffect:function(){}},archeress:{name:"Archeress",sprite:"archeress.png",description:"swift and majestic",outfit:"flowy_rags",skill:"far_shot",equipEffect:function(){},unequipEffect:function(){}},mage:{name:"Mage",sprite:"mage.png",description:"witty and resourceful",outfit:"blue_robe",skill:"fireball",equipEffect:function(){},unequipEffect:function(){}},sorceress:{name:"Sorceress",sprite:"sorceress.png",description:"young and curious",outfit:"purple_robe",skill:"fireball",equipEffect:function(){},unequipEffect:function(){}},ninja:{name:"Ninja",sprite:"ninja.png",description:"silent and deadly",outfit:"ninja_gear",skill:"backstab",equipEffect:function(){},unequipEffect:function(){}},kunoichi:{name:"Kunoichi",sprite:"kunoichi.png",description:"patient and agile",outfit:"black_haori",skill:"backstab",equipEffect:function(){},unequipEffect:function(){}}},SKILL_TYPES:{zen_strike:{name:"Zen Strike",adj:"Zen",noun:"Strike",sprite:"zen_strike.png",rank:"B",description:"1.5k medium-range damage",maxCd:140,range:2,damage:1500,mpCost:20},final_cut:{name:"Final Cut",adj:"Final",noun:"Cut",sprite:"final_cut.png",rank:"S",description:"15k close-range damage",maxCd:300,range:1,damage:15e3,mpCost:50},photosynthesis:{name:"Photosynthesis",adj:"Sunny",noun:"Light",sprite:"photosynthesis.png",rank:"A",description:"Heals HP based on lighting",maxCd:200,mpCost:25,cast:function(e,t){var n=Math.floor(this.game.floors[e.floor].lighting.get(e.x,e.y)[0]/100*.5*e.hpMax);e.heal(n)}},evade:{name:"Evade",adj:"Evading",noun:"Evasion",sprite:"evade.png",rank:"C",description:"Dodges the next attack",maxCd:200,mpCost:10,cast:function(e,t){e.dodges=1}},qi_shot:{name:"Qi Shot",adj:"Qi",noun:"Shot",sprite:"qi_shot.png",rank:"S",description:"300% Medium-range Luck damage",maxCd:200,range:2,damage:1,mpCost:40,cast:function(e,t){this.game.playerSkillAttack(e,t,3*e.luck,this.range,this.splash,this.radial)}},temper_tantrum:{name:"Temper Tantrum",adj:"Temper",noun:"Tantrum",sprite:"temper_tantrum.png",rank:"C",description:"1 ~ 50 medium-range radial damage",maxCd:140,range:2,damage:1,radial:!0,mpCost:10,cast:function(e,t){this.game.playerSkillAttack(e,t,Math.floor(50*Math.random())+1,this.range,this.splash,this.radial)}},foxfire:{name:"Foxfire",adj:"Fox",noun:"Fires",sprite:"foxfire.png",rank:"A",description:"2k medium-range splash damage",maxCd:200,range:2,damage:2e3,splash:!0,mpCost:35},cash_flow:{name:"Cash Flow",adj:"Cashing",noun:"Income",sprite:"cash_flow.png",rank:"B",description:"Obtain 1 to 100 gold",maxCd:200,mpCost:20,cast:function(e,t){e.gold+=Math.floor(100*Math.random())+1}},clean_finish:{name:"Clean Finish",adj:"Clean",noun:"Finish",sprite:"clean_finish.png",rank:"A",description:"4k close-range damage",maxCd:240,range:1,damage:4e3,mpCost:30},embrace:{name:"Embrace",adj:"Embracing",noun:"Embrace",sprite:"embrace.png",rank:"A",description:"Medium-range 3 second stun",maxCd:240,mpCost:20,range:2,duration:60,cast:function(e,t){this.game.playerStunAttack(e,t,this.duration,this.range)}},quick_heal:{name:"Quick Heal",adj:"Healing",noun:"Heal",sprite:"quick_heal.png",rank:"E",description:"10 hp self heal",maxCd:200,mpCost:10,cast:function(e,t){e.heal(10)}},vampiric:{name:"Vampiric",adj:"Vampiric",noun:"Vampire",sprite:"vampiric.png",rank:"C",description:"Passive chance to heal on hit",passive:!0,onHit:function(e,t){Math.random()<.5&&e.heal(1)}},slash:{name:"Slash",adj:"Slashing",noun:"Slash",sprite:"slash.png",rank:"F",description:"15 close-range damage",maxCd:40,range:1,damage:15,mpCost:2},smash:{name:"Smash",adj:"Smashing",noun:"Smash",sprite:"smash.png",rank:"F",description:"10 close-range radial damage",maxCd:40,range:1,damage:10,radial:!0,mpCost:2},far_shot:{name:"Far Shot",adj:"Far",noun:"Shot",sprite:"far_shot.png",rank:"F",description:"13 medium-range damage",maxCd:40,range:2,damage:13,mpCost:2},fireball:{name:"Fireball",adj:"Flaming",noun:"Fireball",sprite:"fireball.png",rank:"F",description:"10 medium-range splash damage",maxCd:40,range:2,damage:10,splash:!0,mpCost:2},backstab:{name:"Backstab",adj:"Flanking",noun:"Backstab",sprite:"backstab.png",rank:"F",description:"20 close-range damage",maxCd:60,range:1,damage:20,mpCost:2},haste:{name:"Haste",adj:"Hasty",noun:"Haste",sprite:"haste.png",rank:"E",description:"Small agi boost for 5 seconds",maxCd:200,range:1,mpCost:5,cast:function(e,t){var n=Math.floor(Math.max(.1*e.agility,1));e.agility+=n,setTimeout((function(){e.agility-=n}),5e3)}},bouncy:{name:"Bouncy",adj:"Bouncy",noun:"Bounce",sprite:"bouncy.png",rank:"F",description:"Does nothing",maxCd:10,range:1,mpCost:5,cast:function(e,t){}},tunnel:{name:"Tunnel",adj:"Tunneling",noun:"Tunnel",sprite:"tunnel.png",rank:"F",description:"Tunnels 2 tiles away",maxCd:100,range:1,mpCost:5,cast:function(e,t){var n=c(e.x,e.y,t.x,t.y,2);this.game.entityCanMoveTo(e,e.floor,n.x,n.y)&&this.game.floors[e.floor].entityManager.move(n.x,n.y,e)}},rock_armor:{name:"Rock Armor",adj:"Rock",noun:"Armor",sprite:"rock_armor.png",rank:"F",description:"Light shielding for 5 seconds",maxCd:200,range:1,mpCost:5,cast:function(e,t){e.damageReduction+=.1,setTimeout((function(){e.damageReduction-=.1}),5e3)}},salt_spray:{name:"Salt Spray",adj:"Salty",noun:"Spray",sprite:"salt_spray.png",rank:"F",description:"10 medium-range splash damage",maxCd:20,range:2,damage:5,mpCost:2},chomp:{name:"Chomp",adj:"Viscious",noun:"Chomp",sprite:"chomp.png",rank:"F",description:"35 close-range damage",maxCd:60,range:1,damage:35,mpCost:5},burst_blade:{name:"Burst Blade",adj:"Burst",noun:"Blade",sprite:"burst_blade.png",rank:"S",description:"10k close-range damage",maxCd:200,range:1,damage:1e4,mpCost:100}},DIRS:{4:[[0,-1],[1,0],[0,1],[-1,0]],8:[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],6:[[-1,-1],[1,-1],[2,0],[1,1],[-1,1],[-2,0]]},DIRECTIONS_4:["up","down","left","right"],KEY_BINDINGS:{up:["↑","W"],down:["↓","S"],left:["←","A"],right:["→","D"],skill:["E"]},KEYCODE_BINDINGS:{37:"left",38:"up",39:"right",40:"down",65:"left",68:"right",69:"skill",83:"down",87:"up"}})},function(e,t,n){"use strict";function r(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}function i(e){let t={},n=e.split("&");for(let e=0,r=n.length;e<r;e++){let r=n[e].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));const r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i={};let o,s=0,a=0;function c(e){let t="";do{t=r[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function l(){const e=c(+new Date);return e!==o?(s=0,o=e):e+"."+c(s++)}for(;a<64;a++)i[r[a]]=a},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r=n(6),i=n(9),o=n(5),s=n(2),a=n(3);const c="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class l extends r.a{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=c?{}:Object(o.c)(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=s.d&&!c?t?new s.a(e,t):new s.a(e):new s.a(e,t,n)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const r=t[n],i=n===t.length-1;Object(a.e)(r,this.supportsBinary,t=>{const n={};if(!s.d&&(r.options&&(n.compress=r.options.compress),this.opts.perMessageDeflate)){("string"==typeof t?e.byteLength(t):t.length)<this.opts.perMessageDeflate.threshold&&(n.compress=!1)}try{s.d?this.ws.send(t):this.ws.send(t,n)}catch(e){}i&&Object(s.c)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Object(i.a)()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!s.a}}}).call(this,n(11).Buffer)},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(13),i=n(14),o=n(15);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(t,n),i=(e=a(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(u(t),e=a(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|p(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function d(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return x(this,t,n);case"utf8":case"utf-8":return B(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return S(this,t,n);case"base64":return A(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){var o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var u=-1;for(o=n;o<a;o++)if(l(e,o)===l(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===c)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){for(var f=!0,h=0;h<c;h++)if(l(e,o+h)!==l(t,h)){f=!1;break}if(f)return o}return-1}function v(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function w(e,t,n,r){return Y(U(t,e.length-n),e,n,r)}function k(e,t,n,r){return Y(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function _(e,t,n,r){return k(e,t,n,r)}function E(e,t,n,r){return Y(F(t),e,n,r)}function T(e,t,n,r){return Y(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function A(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function B(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,c,l=e[i],u=null,f=l>239?4:l>223?3:l>191?2:1;if(i+f<=n)switch(f){case 1:l<128&&(u=l);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&l)<<6|63&o)>127&&(u=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&l)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(u=c)}null===u?(u=65533,f=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=f}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return l(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return u(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return f(null,e)},c.allocUnsafeSlow=function(e){return f(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},c.byteLength=d,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?B(this,0,e):g.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),l=this.slice(r,i),u=e.slice(t,n),f=0;f<a;++f)if(l[f]!==u[f]){o=l[f],s=u[f];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return k(this,e,t,n);case"latin1":case"binary":return _(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function S(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function x(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=q(e[o]);return i}function R(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function I(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function O(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function P(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function M(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function j(e,t,n,r,o){return o||M(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function N(e,t,n,r,o){return o||M(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||L(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||L(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):P(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);L(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);L(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):O(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):O(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):P(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):P(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return j(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return j(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return N(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return N(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=c.isBuffer(e)?e:U(new c(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var D=/[^+\/0-9A-Za-z-_]/g;function q(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function F(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(D,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Y(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(12))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=l(e),s=r[0],a=r[1],c=new o(function(e,t,n){return 3*(t+n)/4-n}(0,s,a)),u=0,f=a>0?s-4:s;for(n=0;n<f;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===a&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[u++]=255&t);1===a&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=0,a=n-i;s<a;s+=16383)o.push(u(e,s,s+16383>a?a:s+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=s.length;a<c;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function u(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,l=c>>1,u=-7,f=n?i-1:0,h=n?-1:1,p=e[t+f];for(f+=h,o=p&(1<<-u)-1,p>>=-u,u+=a;u>0;o=256*o+e[t+f],f+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+e[t+f],f+=h,u-=8);if(0===o)o=1-l;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=l}return(p?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,c,l=8*o-i-1,u=(1<<l)-1,f=u>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+f>=1?h/c:h*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=u?(a=0,s=u):s+f>=1?(a=(t*c-1)*Math.pow(2,i),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[n+p]=255&s,p+=d,s/=256,l-=8);e[n+p-d]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"intervalId",(function(){return Nn})),n.d(t,"stopGame",(function(){return Fn})),n.d(t,"manageLogin",(function(){return Hn}));var r={};n.r(r),n.d(r,"protocol",(function(){return M})),n.d(r,"PacketType",(function(){return j})),n.d(r,"Encoder",(function(){return N})),n.d(r,"Decoder",(function(){return q}));var i=n(6),o=n(9),s=n(3);let a=!1;try{a="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){}const c=a;var l=n(1);function u(e){const t=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!t||c))return new XMLHttpRequest}catch(e){}if(!t)try{return new(l.a[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}var f=n(4),h=n(5);function p(){}const d=null!=new u({xdomain:!1}).responseType;class g extends i.a{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port}const t=e&&e.forceBase64;this.supportsBinary=d&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){Object(s.d)(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,Object(s.f)(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=Object(o.a)()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new m(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class m extends f.a{constructor(e,t){super(),Object(h.b)(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var e;const t=Object(h.c)(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd;const n=this.xhr=new u(t);try{n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}null===(e=this.opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this.opts.cookieJar)||void 0===e||e.parseCookies(n)),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof n.status?n.status:0)},0))},n.send(this.data)}catch(e){return void this.setTimeoutFn(()=>{this.onError(e)},0)}"undefined"!=typeof document&&(this.index=m.requestsCount++,m.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=p,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete m.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(m.requestsCount=0,m.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",y);else if("function"==typeof addEventListener){const e="onpagehide"in l.a?"pagehide":"unload";addEventListener(e,y,!1)}function y(){for(let e in m.requests)m.requests.hasOwnProperty(e)&&m.requests[e].abort()}var b=n(10),v=n(2);class w extends i.a{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{const t=Object(s.a)(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=Object(s.b)();r.readable.pipeTo(e.writable),this.writer=r.writable.getWriter();const i=()=>{n.read().then(({done:e,value:t})=>{e||(this.onPacket(t),i())}).catch(e=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this.writer.write(o).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],r=t===e.length-1;this.writer.write(n).then(()=>{r&&Object(v.c)(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this.transport)||void 0===e||e.close()}}const k={websocket:b.a,webtransport:w,polling:g};var _=n(8);const E=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,T=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function A(e){const t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));let i=E.exec(e||""),o={},s=14;for(;s--;)o[T[s]]=i[s]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(e,t){const n=t.replace(/\/{2,9}/g,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||n.splice(0,1);"/"==t.slice(-1)&&n.splice(n.length-1,1);return n}(0,o.path),o.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,o.query),o}class B extends f.a{constructor(e,t={}){super(),this.binaryType=v.b,this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=A(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=A(t.host).host),Object(h.b)(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=Object(_.a)(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=s.g,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new k[e](n)}open(){let e;if(this.opts.rememberUpgrade&&B.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",e=>this.onClose("transport close",e))}probe(e){let t=this.createTransport(e),n=!1;B.priorWebsocketSuccess=!1;const r=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;B.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function i(){n||(n=!0,l(),t.close(),t=null)}const o=e=>{const n=new Error("probe error: "+e);n.transport=t.name,i(),this.emitReserved("upgradeError",n)};function s(){o("transport closed")}function a(){o("socket closed")}function c(e){t&&e.name!==t.name&&i()}const l=()=>{t.removeListener("open",r),t.removeListener("error",o),t.removeListener("close",s),this.off("close",a),this.off("upgrading",c)};t.once("open",r),t.once("error",o),t.once("close",s),this.once("close",a),this.once("upgrading",c),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onOpen(){if(this.readyState="open",B.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const n=this.writeBuffer[t].data;if(n&&(e+=Object(h.a)(n)),t>0&&e>this.maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const i={type:e,data:t,options:n};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}onError(e){B.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const t=[];let n=0;const r=e.length;for(;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}B.protocol=s.g;B.protocol;const C="function"==typeof ArrayBuffer,S=Object.prototype.toString,x="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===S.call(Blob),R="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===S.call(File);function I(e){return C&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||x&&e instanceof Blob||R&&e instanceof File}function L(e){const t=[],n=e.data,r=e;return r.data=function e(t,n){if(!t)return t;if(I(t)){const e={_placeholder:!0,num:n.length};return n.push(t),e}if(Array.isArray(t)){const r=new Array(t.length);for(let i=0;i<t.length;i++)r[i]=e(t[i],n);return r}if("object"==typeof t&&!(t instanceof Date)){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e(t[i],n));return r}return t}(n,t),r.attachments=t.length,{packet:r,buffers:t}}function O(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<n.length)return n[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=e(t[r],n);else if("object"==typeof t)for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=e(t[r],n));return t}(e.data,t),delete e.attachments,e}const P=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],M=5;var j;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(j||(j={}));class N{constructor(e){this.replacer=e}encode(e){return e.type!==j.EVENT&&e.type!==j.ACK||!function e(t,n){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(e(t[n]))return!0;return!1}if(I(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return!0;return!1}(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===j.EVENT?j.BINARY_EVENT:j.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==j.BINARY_EVENT&&e.type!==j.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=L(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}function D(e){return"[object Object]"===Object.prototype.toString.call(e)}class q extends f.a{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===j.BINARY_EVENT;n||t.type===j.BINARY_ACK?(t.type=n?j.EVENT:j.ACK,this.reconstructor=new U(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!I(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===j[n.type])throw new Error("unknown packet type "+n.type);if(n.type===j.BINARY_EVENT||n.type===j.BINARY_ACK){const r=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const i=e.substring(r,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(i)}if("/"===e.charAt(t+1)){const r=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(r,t)}else n.nsp="/";const r=e.charAt(t+1);if(""!==r&&Number(r)==r){const r=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(r,t+1))}if(e.charAt(++t)){const r=this.tryParse(e.substr(t));if(!q.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case j.CONNECT:return D(t);case j.DISCONNECT:return void 0===t;case j.CONNECT_ERROR:return"string"==typeof t||D(t);case j.EVENT:case j.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===P.indexOf(t[0]));case j.ACK:case j.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class U{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=O(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function F(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const Y=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class H extends f.a{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[F(e,"open",this.onopen.bind(this)),F(e,"packet",this.onpacket.bind(this)),F(e,"error",this.onerror.bind(this)),F(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(Y.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const n={type:j.EVENT,data:t,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]){const e=this.ids++,r=t.pop();this._registerAckCallback(e,r),n.id=e}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!r||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,t){var n;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))},r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(i),t.apply(this,[null,...e])}}emitWithAck(e,...t){const n=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise((r,i)=>{t.push((e,t)=>n?e?i(e):r(t):r(e)),this.emit(e,...t)})}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((e,...r)=>{if(n!==this._queue[0])return;return null!==e?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(e)):(this._queue.shift(),t&&t(null,...r)),n.pending=!1,this._drainQueue()}),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:j.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case j.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case j.EVENT:case j.BINARY_EVENT:this.onevent(e);break;case j.ACK:case j.BINARY_ACK:this.onack(e);break;case j.DISCONNECT:this.ondisconnect();break;case j.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,t.packet({type:j.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:j.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function W(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}W.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},W.prototype.reset=function(){this.attempts=0},W.prototype.setMin=function(e){this.ms=e},W.prototype.setMax=function(e){this.max=e},W.prototype.setJitter=function(e){this.jitter=e};class z extends f.a{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,Object(h.b)(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new W({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||r;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new B(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=F(t,"open",(function(){n.onopen(),e&&e()})),i=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=F(t,"error",i);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),t.close()},e);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(F(e,"ping",this.onping.bind(this)),F(e,"data",this.ondata.bind(this)),F(e,"error",this.onerror.bind(this)),F(e,"close",this.onclose.bind(this)),F(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){Object(v.c)(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new H(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const e of t){if(this.nsps[e].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const K={};function V(e,t){"object"==typeof e&&(t=e,e=void 0);const n=function(e,t="",n){let r=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==n?n.protocol+"//"+e:"https://"+e),r=A(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port+t,r.href=r.protocol+"://"+i+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),r=n.source,i=n.id,o=n.path,s=K[i]&&o in K[i].nsps;let a;return t.forceNew||t["force new connection"]||!1===t.multiplex||s?a=new z(r,t):(K[i]||(K[i]=new z(r,t)),a=K[i]),n.query&&!t.query&&(t.query=n.queryKey),a.socket(n.path,t)}Object.assign(V,{Manager:z,Socket:H,io:V,connect:V});var G=[],J=0,X=0;function $(){J=0,X=0}function Q(e){X||(X=e.t,J=Date.now()),G.push(e);var t=function(){for(var e=X+(Date.now()-J)-100,t=G.length-1;t>=0;t--)if(G[t].t<=e)return t;return-1}();t>0&&G.splice(0,t)}function Z(){return X?G[G.length-1]:{}}var ee={},te=Promise.all(["exit.png","door.png","door_open.png","bush.png","crate.png","boulder.png","leaf_pile.png","mud.png","oak_tree.png","puddle.png","tombstone.png","salt.png","gravel.png","casual_hoodie.png","archeress.png","archery_disciple.png","battle_maid.png","black_swordsman.png","businessman.png","casual_blouse.png","enchantress.png","flower_fighter.png","girl.png","ivory_reaper.png","kendoka.png","kitsune.png","knight.png","knightess.png","kunoichi.png","mage.png","ninja.png","preschooler.png","ranger.png","sorceress.png","warrior.png","warrioress.png","slime.png","goober.png","goblin_king.png","goblin.png","wolf.png","rock_snail.png","ascension_crystal.png","barans_blades.png","coin_stash.png","copper_dagger.png","descension_crystal.png","desolation.png","excalibur.png","fists.png","gold.png","heavens_arrow.png","hp_potion.png","javelin.png","job_change_ticket.png","kings_resent.png","material.png","monster_shard.png","mp_potion.png","mushroom.png","nails.png","rusty_dagger.png","sharp_rock.png","skill_scrollA.png","skill_scrollB.png","skill_scrollC.png","skill_scrollD.png","skill_scrollE.png","skill_scrollF.png","skill_scrollS.png","slime_goo.png","soulstone.png","stinger.png","twig.png","whip_of_fortune.png","wolf_fang.png","wolf_fur.png","wooden_shield.png","wooden_sword.png","slash.png","smash.png","far_shot.png","fireball.png","backstab.png","final_cut.png","burst_blade.png","embrace.png","quick_heal.png","vampiric.png","evade.png","photosynthesis.png","zen_strike.png","haste.png","foxfire.png","qi_shot.png","cash_flow.png","temper_tantrum.png","clean_finish.png","bouncy.png","tunnel.png","feral_claw.png","rock_armor.png","salt_spray.png","chomp.png","cursor.png","drops.png","heal.png","info.png","inventory.png","job.png","mana.png","outfit.png","shop.png","special.png","stats.png","stunned.png","up.png","weapon.png"].map((function(e){return new Promise((function(t){var n=new Image;n.onload=function(){console.log("Downloaded ".concat(e)),ee[e]=n,t()},n.src="/assets/".concat(e)}))})));var ne=function(e){return ee[e]},re=n(0);function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==ie(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==ie(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===ie(o)?o:String(o)),r)}var i,o}n(7);var se=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mergeWithPrevLayer=!1,this.draw=!1,this.cancelTileDrawWhenNotFound=!1,this.type=t;var r=ae[t];for(var i in Object(re.merge)(this,r),n)void 0!==this[i]&&(this[i]=n[i])}var t,n,r;return t=e,(n=[{key:"getTileData",value:function(e,t,n){return!1}},{key:"getModifiedTileData",value:function(e,t,n){var r=this.getTileData(e,t,n);return this.mergeWithPrevLayer&&n?this.mergeTileData(n,r):r}},{key:"mergeTileData",value:function(e,t){var n,r,i={};for(n in e)i[n]=e[n];for(n in t)!1!==(r=t[n])&&void 0!==r&&(i[n]=r);return i}}])&&oe(t.prototype,n),r&&oe(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),ae={map:{merge:!0,cancelTileDrawWhenNotFound:!0,getTileData:function(e,t){var n=Z();if(n.map){var r=n.map[e][t];if(r)return r}}},sprite:{mergeWithPrevLayer:!0,getTileData:function(e,t,n){var r=Z();if(r.sprites){var i=r.sprites[e][t];if(i)return{sprite:i.sprite,stunned:i.stunned}}}},smash:{getTileData:function(e,t){var n=Z();if(n.smash){var r=n.smash[e][t];if(r)return r.char="✹",r.charStrokeWidth=.5,r.sprite=null,r}}},damage:{getTileData:function(e,t){var n=Z();if(n.damage){var r=n.damage[e][t];if(r)return r.charStrokeWidth=2,r.fontSize=50,r}}},info:{getTileData:function(e,t,n){var r=Z();if(r.sprites){var i=r.sprites[e][t];if(i)return{name:i.name,hp:i.hp,hpMax:i.hpMax,offset:i.offset}}}}},ce=["inventory","jobs","outfits","sprite","stats","weapon","socketId"];function le(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var ue,fe=n(7),he=(fe.MAP_SIZE,fe.RENDER_SIZE),pe=fe.TILE_SIZE,de=n(0),ge=de.truncateToFiveCharacters,me=de.mapLengthToFlexTd,ye=de.truncateToFourCharacters,be=de.compareObjects,ve=de.mapJobToSize,we=document.getElementById("map"),ke=we.getContext("2d"),_e=we.cloneNode(),Ee=_e.getContext("2d"),Te=document.getElementById("stat-name"),Ae=document.getElementById("stat-level"),Be=document.getElementById("stat-job"),Ce=document.getElementById("stat-title"),Se=document.getElementById("stat-gold"),xe=document.getElementById("stat-hp"),Re=(document.getElementById("stat-hp-max"),document.getElementById("stat-hp-bar")),Ie=document.getElementById("stat-mp"),Le=(document.getElementById("stat-mp-max"),document.getElementById("stat-mp-bar")),Oe=document.getElementById("stat-strength"),Pe=document.getElementById("stat-vitality"),Me=document.getElementById("stat-agility"),je=document.getElementById("stat-intelligence"),Ne=document.getElementById("stat-luck"),De={},qe=null,Ue=null,Fe=[new se("map",{draw:!0,mergeWithPrevLayer:!1}),new se("sprite",{draw:!0,mergeWithPrevLayer:!1}),new se("smash",{draw:!0,mergeWithPrevLayer:!0}),new se("damage",{draw:!0,mergeWithPrevLayer:!1}),new se("info",{draw:!0,mergeWithPrevLayer:!1})],Ye=he,He=window.devicePixelRatio||1;Math.floor(.5*Ye),Math.floor(.5*Ye);function We(){var e,t;(t=t||Ee).fillStyle=e||"#000",t.fillRect(0,0,we.width,we.height);for(var n=0;n<Fe.length;n++)for(var r=Fe[n],i=Ye-1;i>=0;i--)for(var o=Ye-1;o>=0;o--)ze(i,o,r);qe&&Ee.drawImage(ne("cursor.png"),qe*pe,Ue*pe,pe,pe),function(){var e=Z().player;if(!e)return;e.inventory,e.jobs,e.outfits,e.sprite,e.stats,e.weapon,e.socketId;var t=le(e,ce);if(be(t,De))return;De=t,Te.innerHTML="Name: "+e.name,Ae.innerHTML="Level: "+e.level,e.job?Be.innerHTML="Job: "+e.job:Be.innerHTML="Job: None";if(e.job.length>10){var n=ve("Job: "+e.job);console.log(n),Be.innerHTML=n.text,Be.style.width=n.width+"px",document.getElementById("status-space-flex").style.width=me(Math.max(n.maxLength,e.name.length))}else Be.style.width="auto",document.getElementById("status-space-flex").style.width=me(Math.max(e.job.length,e.name.length));Ce.innerHTML="Title: "+e.title,Se.innerHTML="Gold: "+ge(e.gold),xe.innerHTML="HP: "+ye(e.hp)+"/"+ye(e.hpMax),Re.value=e.hp,Re.max=e.hpMax,Ie.innerHTML="MP: "+ye(e.mp)+"/"+ye(e.mpMax),Le.value=e.mp,Le.max=e.mpMax,Oe.innerHTML="Strength: "+ye(e.strength),Pe.innerHTML="Vitality: "+ye(e.vitality),Me.innerHTML="Agility: "+ye(e.agility),je.innerHTML="Intelligence: "+ye(e.intelligence),Ne.innerHTML="Luck: "+ye(e.luck)}(),function(){"weapon"==Ut?Qt():Zt();switch(function(){var e=Z().player;if(!e)return;var t=e.statPoints;if(null==t)return;if(Jt==t)return;if(Jt=t,t>0){var n=document.getElementById("stat-points");n.innerHTML="(Stat Points: "+t+")";var r,i=Qe(document.querySelectorAll(".player-stat-item"));try{for(i.s();!(r=i.n()).done;){gn(r.value)}}catch(e){i.e(e)}finally{i.f()}gn(n)}else{var o,s=Qe(document.querySelectorAll(".player-stat-item"));try{for(s.s();!(o=s.n()).done;){dn(o.value)}}catch(e){s.e(e)}finally{s.f()}dn(document.getElementById("stat-points"))}}(),function(){var e=Z().player;if(!e)return;var t=e.dead;if(Xt==t)return;Xt=t;var n=document.getElementById("game-over-overlay"),r=document.getElementById("respawn-menu");t?(n.style.zIndex=5,gn(n),r.style.zIndex=6,gn(r)):(dn(n),dn(r),n.style.zIndex=-1,r.style.zIndex=-1,t=!1)}(),Dt){case"shop":return void("buy"==qt?en(!1):tn(!1));case"inventory":return void function(){var e=Z().player;if(!e)return;var t=e.inventory;if(!t)return;if(Object(re.compareArraysOfObjects)(Ft,t))return;Ft=t;for(var n="",r="",i="",o=0;o<t.length;o++)n='<img src="assets/'+t[o].sprite+'"/>',r=Object(re.rankToColorHtml)(t[o].rank),i+='<div class="menu-item" id="inventory-item-'+o+'"><div class="menu-item-icon">'+n+'</div><div class="menu-item-info"><h4>'+r+t[o].name+" - ​"+t[o].rank+"</span><br> <span>"+t[o].stats+'</span></h4></div><div class="menu-item-amount"><h4>x'+t[o].amount+'</h4></div><div class="menu-item-confirm" id="inventory-item-confirm-'+o+'"><h4> <span> use item?</span><br><p id="inventory-item-confirm-yes-'+o+'"> ✔</p> <p id="inventory-item-confirm-no-'+o+'">✘</p></h4></div></div>';Lt.innerHTML=i,mn(t,"inventory","use-inventory")}();case"jobs":return void function(){var e=Z().player;if(!e)return;var t=e.jobs;if(!t)return;if(Object(re.compareArraysOfObjects)(zt,t))return;zt=t;for(var n="",r="",i=0;i<t.length;i++)n='<img src="assets/icons/'+t[i].sprite+'"/>',r+='<div class="menu-item" id="job-item-'+i+'"><div class="menu-item-icon">'+n+'</div><div class="menu-item-info"><h4>'+t[i].name+'<br> <span style="color: #ffffff33;">'+t[i].description+'</span></h4></div><div class="menu-item-confirm" id="job-item-confirm-'+i+'"><h4> <span> Change job?</span><br><p id="job-item-confirm-yes-'+i+'"> ✔</p> <p id="job-item-confirm-no-'+i+'">✘</p></h4></div></div>';Mt.innerHTML=r,mn(t,"job","use-job")}();case"outfits":return void function(){var e=Z().player;if(!e)return;var t=e.outfits;if(!t)return;if(Object(re.compareArraysOfObjects)(Kt,t))return;Kt=t;for(var n="",r="",i=0;i<t.length;i++)n='<img src="assets/icons/'+t[i].sprite+'"/>',r+='<div class="menu-item" id="outfit-item-'+i+'"><div class="menu-item-icon">'+n+'</div><div class="menu-item-info"><h4>'+t[i].name+'<br> <span style="color: #ffffff33;">'+t[i].description+'</span></h4></div><div class="menu-item-confirm" id="outfit-item-confirm-'+i+'"><h4> <span> Change outfit?</span><br><p id="outfit-item-confirm-yes-'+i+'"> ✔</p> <p id="outfit-item-confirm-no-'+i+'">✘</p></h4></div></div>';Ot.innerHTML=r,mn(t,"outfit","use-outfit")}();case"stats":return void function(){var e=Z().playerList;if(!e)return;for(var t="",n="",r=0;r<e.length;r++)t='<img src="assets/icons/'+e[r].sprite+'"/>',n+='<div class="menu-item" id="stats-item-'+r+'"><div class="menu-item-icon">'+t+'</div><div class="menu-item-info"><h4>'+e[r].name+'</span> <br> <span style="color: #ffffff33;">'+e[r].job+" - Lvl ​"+e[r].level+"</span></h4></div></div>";Nt.innerHTML=n}();case"skills":!function(){var e=Z().player;if(!e)return;var t=e.skills;if(!t)return;if(Object(re.compareArraysOfObjects)(Wt,t))return;Wt=t;for(var n="",r="",i="",o=0;o<t.length;o++)n='<img src="assets/'+t[o].sprite+'" class="skills-img"/>',r=Object(re.rankToColorHtml)(t[o].rank),i+='<div class="menu-item" id="skills-item-'+o+'"><div class="menu-item-icon2">'+n+'</div><div class="menu-item-info"><h4>'+r+t[o].name+" - ​"+t[o].rank+"</span><br> <span>"+t[o].description+'</span></h4></div><div class="menu-item-confirm" id="skills-item-confirm-'+o+'"><h4> <span> Fuse skill?</span><br><p id="skills-item-confirm-yes-'+o+'"> ✔</p> <p id="skills-item-confirm-no-'+o+'">✘</p></h4></div></div>';Pt.innerHTML=i,mn(t,"skills","fuse-skills")}()}}(),ke.drawImage(_e,0,0,we.width,we.height),ue=requestAnimationFrame(We)}function ze(e,t,n){var r={};if(r=n.getModifiedTileData(e,t,r),n.cancelTileDrawWhenNotFound&&!r)return!1;r&&n.draw&&function(e,t,n,r){r=r||Ee,n.bgColor&&(r.fillStyle=n.bgColor,r.fillRect(e*pe,t*pe,pe,pe));var i=e*pe+.5*pe+(n.offsetX||0),o=t*pe+.5*pe+(n.offsetY||0);if(n.sprite){var s=ne(n.sprite),a=pe/2,c=pe;n.stunned?(r.globalAlpha=.5,r.drawImage(s,i-a,o-a,c,c),r.globalAlpha=1,r.drawImage(ne("stunned.png"),i-a+20,o-a-10,20,20)):r.drawImage(s,i-a,o-a,c,c)}else if(n.char&&n.color){n.mask&&(r.save(),r.beginPath(),r.rect(e*pe,t*pe,pe,pe),r.clip(),r.closePath());var l=n.fontSize||pe,u=e*pe+.5*pe+(n.offsetX||0),f=t*pe+.5*pe+(n.offsetY||0);r.fillStyle=n.color,r.textAlign=n.textAlign||"center",r.textBaseline=n.textBaseline||"middle",r.font=l+"px "+(n.font||"Friend"),n.charStrokeColor&&(r.strokeStyle=n.charStrokeColor,r.lineWidth=n.charStrokeWidth||1,r.strokeText(n.char,u,f),r.strokeText(n.char,u,f+1)),r.fillText(n.char,u,f),n.mask&&r.restore()}if(n.hp&&n.hp!=n.hpMax){var h=e*pe+.1*pe,p=t*pe+.5*pe+25,d=Math.round(n.hp/n.hpMax*(.8*pe));r.lineWidth=1,r.strokeStyle="#e5e5e5",r.fillStyle="#71bc68",r.fillRect(h,p,d,4),r.strokeRect(h,p,.8*pe,4)}if(n.name){l=pe/4;var g=e*pe+.5*pe,m=t*pe+.5*pe+33;n.hp!=n.hpMax&&(m+=5),r.fillStyle="#e5e5e5",r.textAlign="center",r.textBaseline="middle",r.font=l+"px "+(n.font||"Friend"),r.fillText(n.name.toUpperCase(),g,m)}if(n.borderColor){var y=n.borderWidth||1,b=Math.floor(.5*y),v=pe-y;y%2!=0&&(b+=.5),r.lineWidth=y,r.strokeStyle=n.borderColor;var w=e*pe+b,k=t*pe+b;r.strokeRect(w,k,v,v)}}(e,t,r,Ee)}function Ke(e,t){var n=we.getBoundingClientRect();return{x:e-n.left,y:t-n.top}}function Ve(e){var t=Ke(e.clientX,e.clientY);qe=Math.floor(t.x/fe.TILE_SIZE),Ue=Math.floor(t.y/fe.TILE_SIZE)}function Ge(e){qe=null,Ue=null}function Je(){ue=requestAnimationFrame(Je)}function Xe(){document.getElementById("start-menu").style.display="none";var e=document.getElementById("game");e.style.height="auto",e.style.opacity=1,e.style.overflow="visible",cancelAnimationFrame(ue),ue=requestAnimationFrame(We)}function $e(e){return t=e.name,n=e.color,r="","string"==typeof n&&(r=' style="color:'+n+'"'),"<span"+r+">"+t+"</span>";var t,n,r}function Qe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ze(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){void 0!==e&&(Ye=e);e=Ye*pe,1!==He&&(we.style.width=e+"px",we.style.height=e+"px",_e.style.width=e+"px",_e.style.height=e+"px",e=Math.round(e*He));we.width=e,we.height=e,_e.width=e,_e.height=e,Ee.scale(He,He),Math.floor(.5*Ye),Math.floor(.5*Ye)}(Ye);var et=n(7),tt=document.getElementById("skill-weapon"),nt=document.getElementById("skill-skills"),rt=(document.getElementById("skill-foot"),document.getElementById("skill-body")),it=document.getElementById("shop-buy"),ot=document.getElementById("shop-sell"),st=document.getElementById("pr-inventory"),at=document.getElementById("pr-shop"),ct=document.getElementById("pr-stats"),lt=document.getElementById("pr-skills"),ut=document.getElementById("pr-jobs"),ft=document.getElementById("pr-outfits"),ht=document.getElementById("inventory-window"),pt=document.getElementById("shop-window"),dt=document.getElementById("stats-window"),gt=document.getElementById("skills-window"),mt=document.getElementById("jobs-window"),yt=document.getElementById("outfits-window"),bt=document.getElementById("inventory-foot-type"),vt=document.getElementById("inventory-foot-rarity"),wt=document.getElementById("inventory-foot-name"),kt=document.getElementById("shop-foot"),_t=document.getElementById("shop-foot-type"),Et=document.getElementById("shop-foot-rarity"),Tt=document.getElementById("shop-foot-name"),At=document.getElementById("stats-foot-type"),Bt=document.getElementById("stats-foot-rarity"),Ct=document.getElementById("stats-foot-name"),St=document.getElementById("skills-foot-rarity"),xt=document.getElementById("skills-foot-name"),Rt=document.getElementById("jobs-foot-name"),It=document.getElementById("outfits-foot-name"),Lt=document.getElementById("inventory-body"),Ot=document.getElementById("outfits-body"),Pt=document.getElementById("skills-body"),Mt=document.getElementById("jobs-body"),jt=document.getElementById("shop-body"),Nt=document.getElementById("stats-body"),Dt="none",qt="buy",Ut="weapon",Ft=[],Yt=[],Ht=[],Wt=[],zt=[],Kt=[],Vt=[],Gt=null,Jt=null,Xt=null,$t=null;function Qt(e){tt.style.color="#e5e5e5",nt.style.color="#ffffff33";var t=Z().player;if(t){var n=t.weapon;if(n&&(e||!Object(re.compareObjects)($t,n))){$t=n;var r="";r+='<div class="weapon-icon"><img src="assets/'+n.sprite+'"/></div><div class="newline"></div><div class="tr"><div class="td_weapon" >[Name: '+$e(n)+']</div></div><div class="tr"><div class="td_weapon">Weapon Rank: '+n.rank+'</div></div><div class="tr"><div class="td_weapon">Modifiers: '+n.stats+'</div></div><div class="tr"><div class="td_weapon">Range: '+n.range+"</div></div>",rt.innerHTML=r}}}function Zt(e){tt.style.color="#ffffff33",nt.style.color="#e5e5e5";var t=Z().player;if(t){var n=t.fusedSkill;if(n&&(e||!Object(re.compareArraysOfObjects)(Vt,n.list)||n.currCd!=Gt)){Vt=n.list,Gt=n.currCd;var r="";Vt.length>0&&(r+='<div class="skill-icon"><div id="skill-overlay-container"><div id="skill-overlay"></div></div><div class="skill-icon-img" id="skill-icon-img"></div></div>'),rt.innerHTML=r;for(var i="",o=1;o<=n.list.length;o++)i+="#section".concat(o," { background-position: 0 ").concat(-100*(o-1),"%; }");var s=document.createElement("style");s.innerHTML="\n    .skill-icon-img {\n      width:80%;\n      height:80%;\n      margin-left: 10%;\n      margin-top: 10%;\n      filter: drop-shadow(0 0 5px 3px rgba(255,255,255,0.5));\n      -webkit-filter: drop-shadow(0 0 5px rgba(255,255,255,0.5));\n      display: grid;\n      grid-template-rows: repeat(".concat(n.list.length,", 1fr);\n      border-radius: 5px;\n      overflow: hidden;\n      z-index: 1;\n    }\n    .collage-section {\n      width: 100%;\n      height: 100%;\n      background-size: 100% ").concat(100*n.list.length,"%;\n    }\n    ").concat(i,"\n  ");var a=document.getElementById("collage-styles");a&&document.head.removeChild(a),s.id="collage-styles",document.head.appendChild(s);for(var c=document.getElementById("skill-icon-img"),l=0;l<n.list.length;l++){var u=document.createElement("div");u.classList.add("collage-section"),u.id="section".concat(l+1),u.style.backgroundImage="url('assets/".concat(n.list[l].sprite,"')"),c.appendChild(u)}var f=document.getElementById("skill-overlay");if(f){var h=100*(1-n.currCd/n.maxCd);f.style.transform="scaleX(".concat(1-h/100,")")}n.name&&(rt.innerHTML+='<div class="newline"></div> <div class="tr"><div class="td_weapon" >[Name: '+$e(n)+']</div></div><div class="tr"><div class="td_weapon">Fusion Skill Rank: '+n.rank+'</div></div><div class="tr"><div class="td_weapon">MP Cost: '+n.mpCost+'</div></div><div class="tr"><div class="td_weapon">Cooldown: '+n.cd+" Sec</div></div>")}}}function en(e){dn(kt),ot.style.color="#ffffff33",it.style.color="#e5e5e5";var t=Z().shop;if(t&&(e||!Object(re.compareArraysOfObjects)(Yt,t))){Yt=t;for(var n="",r=0;r<t.length;r++)n+='<div class="menu-item" id="shop-item-'+r+'"><div class="menu-item-icon">'+('<img src="assets/'+t[r].sprite+'"/>')+'</div><div class="menu-item-info"><h4>'+Object(re.rankToColorHtml)(t[r].rank)+t[r].name+" - ​"+t[r].rank+"</span> <br> <span>"+t[r].stats+'</span></h4></div><div class="menu-item-amount"><img src="assets/icons/gold.png"/><p>'+Object(re.truncateToFiveCharacters)(t[r].cost)+'</p></div><div class="menu-item-confirm" id="shop-item-confirm-'+r+'"><h4> <span> Buy item?</span><br><p id="shop-item-confirm-yes-'+r+'"> ✔</p> <p id="shop-item-confirm-no-'+r+'">✘</p></h4></div></div>';jt.innerHTML=n,mn(t,"shop","use-shop")}}function tn(e){gn(kt),it.style.color="#ffffff33",ot.style.color="#e5e5e5";var t=Z().player;if(t){var n=t.inventory;if(n&&(e||!Object(re.compareArraysOfObjects)(Ht,n))){Ht=n;for(var r="",i=0;i<n.length;i++)r+='<div class="menu-item" id="sell-item-'+i+'"><div class="menu-item-icon">'+('<img src="assets/'+n[i].sprite+'"/>')+'</div><div class="menu-item-info"><h4>'+Object(re.rankToColorHtml)(n[i].rank)+n[i].name+" - ​"+n[i].rank+"</span><br> <span>"+n[i].stats+'</span></h4></div><div class="menu-item-amount"><h4>x'+n[i].amount+'</h4></div><div class="menu-item-confirm" id="sell-item-confirm-'+i+'"><h4> <span> Sell item?</span><br><p id="sell-item-confirm-yes-'+i+'"> ✔</p> <p id="sell-item-confirm-no-'+i+'">✘</p></h4></div></div>';jt.innerHTML=r,mn(n,"sell","use-sell")}}}function nn(){Dt="inventory",gn(ht),dn(pt),dn(dt),dn(gt),dn(mt),dn(yt)}function rn(){Dt="shop",gn(pt),dn(ht),dn(dt),dn(gt),dn(mt),dn(yt)}function on(){Dt="stats",gn(dt),dn(ht),dn(pt),dn(gt),dn(mt),dn(yt)}function sn(){Dt="skills",gn(gt),dn(ht),dn(pt),dn(dt),dn(mt),dn(yt)}function an(){Dt="jobs",gn(mt),dn(ht),dn(pt),dn(dt),dn(gt),dn(yt)}function cn(){Dt="outfits",gn(yt),dn(ht),dn(pt),dn(dt),dn(gt),dn(mt)}function ln(){"rgb(229, 229, 229)"==Rt.style.color?Rt.style.color="#ffffff33":Rt.style.color="#e5e5e5",Sn({type:"sort-jobs-name"})}function un(){"rgb(229, 229, 229)"==It.style.color?It.style.color="#ffffff33":It.style.color="#e5e5e5",Sn({type:"sort-outfits-name"})}function fn(){"rgb(229, 229, 229)"==At.style.color?At.style.color="#ffffff33":At.style.color="#e5e5e5",Bt.style.color="#ffffff33",Ct.style.color="#ffffff33",Sn({type:"sort-stats-type"})}function hn(){"rgb(229, 229, 229)"==Bt.style.color?Bt.style.color="#ffffff33":Bt.style.color="#e5e5e5",At.style.color="#ffffff33",Ct.style.color="#ffffff33",Sn({type:"sort-stats-rarity"})}function pn(){"rgb(229, 229, 229)"==Ct.style.color?Ct.style.color="#ffffff33":Ct.style.color="#e5e5e5",At.style.color="#ffffff33",Bt.style.color="#ffffff33",Sn({type:"sort-stats-name"})}function dn(e){e.style.visibility="hidden",e.style.opacity=0}function gn(e){e.style.visibility="visible",e.style.opacity=1}function mn(e,t,n){for(var r=function(e){document.getElementById(t+"-item-"+e).addEventListener("click",(function(n){var r;n.stopPropagation(),1==(r=document.getElementById(t+"-item-confirm-"+e)).style.opacity?dn(r):gn(r)})),document.getElementById(t+"-item-confirm-yes-"+e).addEventListener("click",(function(r){r.stopPropagation(),dn(document.getElementById(t+"-item-confirm-"+e)),Sn({type:n,index:e})})),document.getElementById(t+"-item-confirm-no-"+e).addEventListener("click",(function(n){n.stopPropagation(),dn(document.getElementById(t+"-item-confirm-"+e))}))},i=0;i<e.length;i++)r(i)}function yn(e){document.getElementById(e.type+"-console-h4").innerHTML=e.message,gn(document.getElementById(e.type+"-console")),setTimeout((function(){dn(document.getElementById(e.type+"-console"))}),3e3)}function bn(e){if(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey)return!0;var t=function(e){return e in et.KEYCODE_BINDINGS&&et.KEYCODE_BINDINGS[e]}(e.keyCode);return!1===t||("skill"==t?xn({x:qe,y:Ue}):Bn(t),e.preventDefault(),!1)}function vn(e){var t=Ke(e.clientX,e.clientY);Cn(t)}function wn(){st.addEventListener("click",nn),at.addEventListener("click",rn),ct.addEventListener("click",on),lt.addEventListener("click",sn),ut.addEventListener("click",an),ft.addEventListener("click",cn),bt.addEventListener("click",(function(e){e.stopPropagation(),"rgb(229, 229, 229)"==bt.style.color?bt.style.color="#ffffff33":bt.style.color="#e5e5e5",vt.style.color="#ffffff33",wt.style.color="#ffffff33",Sn({type:"sort-inventory-type"})})),vt.addEventListener("click",(function(e){e.stopPropagation(),"rgb(229, 229, 229)"==vt.style.color?vt.style.color="#ffffff33":vt.style.color="#e5e5e5",bt.style.color="#ffffff33",wt.style.color="#ffffff33",Sn({type:"sort-inventory-rarity"})})),wt.addEventListener("click",(function(e){e.stopPropagation(),"rgb(229, 229, 229)"==wt.style.color?wt.style.color="#ffffff33":wt.style.color="#e5e5e5",bt.style.color="#ffffff33",vt.style.color="#ffffff33",Sn({type:"sort-inventory-name"})})),_t.addEventListener("click",(function(e){e.stopPropagation(),"rgb(229, 229, 229)"==_t.style.color?_t.style.color="#ffffff33":_t.style.color="#e5e5e5",Et.style.color="#ffffff33",Tt.style.color="#ffffff33",Sn({type:"sort-inventory-type"})})),Et.addEventListener("click",(function(e){e.stopPropagation(),"rgb(229, 229, 229)"==Et.style.color?Et.style.color="#ffffff33":Et.style.color="#e5e5e5",_t.style.color="#ffffff33",Tt.style.color="#ffffff33",Sn({type:"sort-inventory-rarity"})})),Tt.addEventListener("click",(function(e){e.stopPropagation(),"rgb(229, 229, 229)"==Tt.style.color?Tt.style.color="#ffffff33":Tt.style.color="#e5e5e5",_t.style.color="#ffffff33",Et.style.color="#ffffff33",Sn({type:"sort-inventory-name"})})),At.addEventListener("click",fn),Bt.addEventListener("click",hn),Ct.addEventListener("click",pn),St.addEventListener("click",(function(e){e.stopPropagation(),"rgb(229, 229, 229)"==St.style.color?St.style.color="#ffffff33":St.style.color="#e5e5e5",xt.style.color="#ffffff33",Sn({type:"sort-skills-rarity"})})),xt.addEventListener("click",(function(e){e.stopPropagation(),"rgb(229, 229, 229)"==xt.style.color?xt.style.color="#ffffff33":xt.style.color="#e5e5e5",St.style.color="#ffffff33",Sn({type:"sort-skills-name"})})),Rt.addEventListener("click",ln),It.addEventListener("click",un),document.getElementById("shop-buy").addEventListener("click",(function(){qt="buy",en(!0)})),document.getElementById("shop-sell").addEventListener("click",(function(){qt="sell",tn(!0)})),document.getElementById("skill-weapon").addEventListener("click",(function(){Ut="weapon",Qt(!0)})),document.getElementById("skill-skills").addEventListener("click",(function(){Ut="skill",Zt(!0)})),document.addEventListener("click",(function(){for(var e=document.getElementsByClassName("menu-item-confirm"),t=0;t<e.length;t++)dn(e[t])})),document.getElementById("up-strength").addEventListener("click",(function(){Sn({type:"up-stat",stat:"strength"})})),document.getElementById("up-vitality").addEventListener("click",(function(){Sn({type:"up-stat",stat:"vitality"})})),document.getElementById("up-agility").addEventListener("click",(function(){Sn({type:"up-stat",stat:"agility"})})),document.getElementById("up-intelligence").addEventListener("click",(function(){Sn({type:"up-stat",stat:"intelligence"})})),document.getElementById("up-luck").addEventListener("click",(function(){Sn({type:"up-stat",stat:"luck"})})),document.getElementById("respawn-button").addEventListener("click",(function(){Sn({type:"respawn"}),Ft=[],Yt=[],Ht=[],Wt=[],zt=[],Kt=[],Vt=[],Jt=null,Xt=null,$t=null}))}function kn(){document.addEventListener("keydown",bn);var e=document.getElementById("map");e.addEventListener("click",vn),e.addEventListener("mousemove",Ve),e.addEventListener("mouseenter",Ve),e.addEventListener("mouseleave",Ge),wn()}var _n=n(7),En=window.location.protocol.includes("https")?"wss":"ws",Tn=V("".concat(En,"://").concat(window.location.host),{reconnection:!0}),An=new Promise((function(e){Tn.on("connect",(function(){console.log("Connected to server!"),e()}))})),Bn=function(e){Tn.connected?Tn.emit(_n.MSG_TYPES.INPUT,e):console.log("Not connected to server.")},Cn=function(e){Tn.connected?Tn.emit(_n.MSG_TYPES.MOUSE_MAP_INPUT,e):console.log("Not connected to server.")},Sn=function(e){Tn.connected?Tn.emit(_n.MSG_TYPES.MENU_INPUT,e):console.log("Not connected to server.")},xn=function(e){Tn.connected?Tn.emit(_n.MSG_TYPES.SKILL_INPUT,e):console.log("Not connected to server.")},Rn=(n(16),n(17),document.getElementById("start-button")),In=document.getElementById("name-input"),Ln=document.getElementById("start-text"),On=document.getElementById("start-name-prompt"),Pn=document.getElementById("name-input"),Mn=document.getElementById("class-select"),jn=document.getElementById("login-button"),Nn=null,Dn="",qn=null;function Un(){document.getElementById("start-arrow").style.display="none",jn.style.display="none",In.style.visibility="visible",In.style.opacity=1,Ln.style.visibility="hidden",Ln.style.opacity=0,On.style.visibility="visible",On.style.opacity=1,In.addEventListener("keyup",(function(e){if("Enter"===e.key){var t=document.getElementById("start-button"),n=t.cloneNode(!0);t.parentNode.replaceChild(n,t);var r=document.getElementById("start-class-prompt"),i=document.getElementById("start-name-prompt");r.style.visibility="visible",r.style.opacity=1,i.style.visibility="hidden",i.style.opacity=0,Pn.style.visibility="hidden",Pn.style.opacity=0,Mn.style.visibility="visible",Mn.style.opacity=1,document.getElementById("class-knight").addEventListener("click",(function(){Dn="knight",Yn()})),document.getElementById("class-knightess").addEventListener("click",(function(){Dn="knightess",Yn()})),document.getElementById("class-warrior").addEventListener("click",(function(){Dn="warrior",Yn()})),document.getElementById("class-warrioress").addEventListener("click",(function(){Dn="warrioress",Yn()})),document.getElementById("class-mage").addEventListener("click",(function(){Dn="mage",Yn()})),document.getElementById("class-sorceress").addEventListener("click",(function(){Dn="sorceress",Yn()})),document.getElementById("class-ranger").addEventListener("click",(function(){Dn="ranger",Yn()})),document.getElementById("class-archeress").addEventListener("click",(function(){Dn="archeress",Yn()})),document.getElementById("class-ninja").addEventListener("click",(function(){Dn="ninja",Yn()})),document.getElementById("class-kunoichi").addEventListener("click",(function(){Dn="kunoichi",Yn()}))}}))}function Fn(){!function(){document.removeEventListener("keydown",bn);var e=document.getElementById("map");e.removeEventListener("click",vn),e.removeEventListener("mousemove",Ve),e.removeEventListener("mouseenter",Ve),e.removeEventListener("mouseleave",Ge)}(),cancelAnimationFrame(ue),ue=requestAnimationFrame(Je)}function Yn(){!function(e){Tn.connected?Tn.emit(_n.MSG_TYPES.NEW_PLAYER,e):console.log("Not connected to server.")}({name:In.value,job:Dn,discordId:qn}),$(),kn(),Xe(),Nn=setInterval((function(){console.log(Z())}),2e3)}function Hn(e){"newPlayer"==e.message?(Un(),qn=e.discordId):($(),kn(),Xe(),Nn=setInterval((function(){console.log(Z())}),2e3))}Promise.all([An.then((function(){Tn.on(_n.MSG_TYPES.GAME_UPDATE,Q),Tn.on(_n.MSG_TYPES.AUTHENTICATED,Hn),Tn.on(_n.MSG_TYPES.LOG_MESSAGE,yn),Tn.on("disconnect",(function(){console.log("Disconnected from server."),Fn()}))})),te]).then((function(){var e=new URLSearchParams(window.location.search).get("code");e?(console.log("code sending"),function(e){Tn.connected?Tn.emit(_n.MSG_TYPES.AUTHENTICATE,e):console.log("Not connected to server.")}(e)):Rn.onclick=function(){Un()}})).catch(console.error)}]);